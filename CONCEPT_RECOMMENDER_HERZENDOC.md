# Концепция платформы интерактивных учебников `.herzendoc`

## 1) Идея в одном абзаце
Платформа использует учебные материалы в формате `.herzendoc`, где главы, термины, определения, контрольные вопросы и ключи размечены специальными маркерами. На базе этой разметки строится граф зависимостей знаний (термины ↔ главы ↔ вопросы). После входного тестирования система определяет текущий уровень ученика и рекомендует следующую главу: одновременно логически допустимую по prerequisite-связям и наиболее полезную с точки зрения опыта предыдущих учеников.

## 2) Что должно быть в `.herzendoc`
Минимальный набор сущностей в документе:
- **Глава**: идентификатор, название, основной текст.
- **Термин**: уникальный ключ, краткое определение.
- **Связи терминов**: какие термины используются в главе.
- **Вопросы**: список вопросов к главе.
- **Ключи**: эталонные ответы/варианты/правильные ответы.

Практический эффект:
- можно кликнуть на термин в тексте и перейти к его определению;
- можно вернуться назад к месту чтения;
- можно оценить, какие термины уже покрыты, а какие — нет.

## 3) Пользовательский сценарий
1. Студент входит в систему.
2. Проходит входное тестирование по терминам/базовым вопросам курса.
3. Система вычисляет стартовый вектор освоения (какие термины уже усвоены).
4. Рекомендательная система предлагает следующую главу.
5. После изучения главы и мини-проверки модель обновляет профиль студента.
6. Цикл повторяется до покрытия целевого набора знаний.

## 4) Рекомендательная логика (гибрид)
Рекомендуется комбинировать два слоя:

### A. Логический слой (обязательный)
- строит DAG/граф зависимостей: глава может быть рекомендована только если выполнены prerequisites;
- защищает от «прыжков» в тему без нужных терминов.

### B. Персонализирующий слой (поверх логики)
- среди допустимых глав ранжирует по ожидаемой полезности;
- использует сигналы: успехи студентов с похожим профилем, время освоения, ошибки по терминам, сложность главы.

Итоговая рекомендация = `argmax(score)` по множеству логически допустимых глав.

## 5) Предложенная архитектура (Thymeleaf + Java)

### Backend (Java)
Модули:
- `parser` — разбор `.herzendoc` и валидация структуры;
- `domain` — сущности: `Chapter`, `Term`, `Definition`, `Question`, `StudentProfile`;
- `graph` — построение графа зависимостей знаний;
- `assessment` — входное и итоговое тестирование;
- `recommender` — ранжирование следующих глав;
- `tracking` — события обучения (просмотр, клик на термин, успешность ответов);
- `api` — контроллеры для фронтенда.

### Frontend (Thymeleaf)
Страницы:
- каталог/выбор курса;
- страница чтения главы с кликабельными терминами;
- модальное окно/side panel определения;
- входной тест;
- экран рекомендаций следующей главы и объяснение «почему именно она».

## 6) Модель данных (минимум)
- `courses(id, name)`
- `chapters(id, course_id, title, content, difficulty)`
- `terms(id, course_id, key, definition)`
- `chapter_terms(chapter_id, term_id, role)`
- `chapter_prerequisites(chapter_id, prerequisite_chapter_id)`
- `questions(id, chapter_id, type, prompt, answer_key)`
- `students(id, ... )`
- `student_knowledge(student_id, term_id, mastery_score)`
- `learning_events(id, student_id, chapter_id, event_type, ts, payload)`
- `recommendation_log(id, student_id, chapter_id, score, reason, ts)`

## 7) Метрики качества исследования
- **Learning Gain**: прирост результатов до/после.
- **Time-to-Mastery**: время до целевого уровня по терминам.
- **Recommendation Acceptance Rate**: как часто студент следует рекомендации.
- **Drop-off Rate**: где учащиеся прекращают путь.
- **Prerequisite Violation Rate**: как часто система предлагала слишком сложную тему (должно стремиться к 0).

## 8) План MVP
1. Спецификация `.herzendoc` + базовый парсер.
2. Визуализация главы и терминов (клик + возврат).
3. Входной тест и первичная оценка mastery по терминам.
4. Графовая рекомендательная логика без ML.
5. Логирование взаимодействий.
6. Базовое ранжирование по историческим данным (collaborative/component scoring).
7. Дашборд метрик.

## 9) Научная новизна (как сформулировать)
- Не просто контекстные рекомендации «что читать дальше», а **старт с оценки уровня терминологического владения**.
- Рекомендации строятся на пересечении:
  1) формального графа образовательных зависимостей;
  2) эмпирики прохождения у предыдущих студентов.
- Это снижает cold-start в рамках конкретного курса и ускоряет выход на эффективную траекторию.

## 10) Риски и как смягчать
- **Слабая разметка `.herzendoc`** → строгий валидатор и линтер формата.
- **Шум в входном тесте** → адаптивный тест (2–3 уточняющих вопроса по спорным терминам).
- **Переобучение под прошлый поток** → регуляризация, ограничение веса исторических сигналов.
- **Непрозрачность рекомендаций** → обязательное объяснение «почему эта глава».
